#: import ListAdapter kivy.adapters.listadapter.ListAdapter
#: import Factory kivy.factory.Factory
#: import get_color_from_hex kivy.utils.get_color_from_hex
#: import win kivy.core.window
#: import default_font_name main.DEFAULT_FONT


<Label>
    font_name: default_font_name

<Button>
    background_down: ""
    background_disabled_down: ""
    background_disabled_normal: ""
    background_normal: ""
    background_color: get_color_from_hex('DDDDDD')
    halign: 'center'

<ImageSelectButton>
    background_down: ""
    background_disabled_down: ""
    background_disabled_normal: ""
    background_normal: ""
    background_color: get_color_from_hex('F5F5F5')
    group: 'images'
    allow_no_selection: False

<Pictures>
    canvas.before:
        Color:
            rgba: get_color_from_hex('F5F5F5')
        Rectangle:
            pos: self.pos
            size: self.size

    columns: 1
    rows: 3
    size_hint: 1, None
    height: '140px'

    ImageSelectButton:
        size_hint: None, None
        width: '140px'
        height: '140px'
        on_parent: self._do_press() if root.is_selected else True
        image_source: image_source

        AsyncImage:
            id: image_source
            size_hint: None, None
            y: self.parent.y + self.parent.height - 130
            x: self.parent.x + 10
            width: '120px'
            height: '120px'
            source: root.path


<Label>
    shorten: True
    markup: True
    shorten_from: 'right'
    text_size: self.width, None
    color: get_color_from_hex('000000')

<PictureViewer>
    canvas.before:
        Color:
            rgba: get_color_from_hex('F5F5F5')
        Rectangle:
            pos: self.pos
            size: self.size

    columns: 3
    rows: 1
    spacing: '5px', '5px'

    picture: picture
    photo: photo
    file_chooser: file_chooser

    FileChooserListView:
        id: file_chooser
        size_hint: None, 1
        width: '250px'
        dirselect: True
        show_hidden: True
        filters: root.filters
        path: "/"
        color: get_color_from_hex('000000')
        on_submit: root.select_source(self.selection)

    GridLayout:
        id: picture
        columns: 1
        rows: 3
        spacing: '5px'
        image_name: image_name
        image_source: image_source

        Scatter:
            id: photo
            do_translation: False
            do_scale: False
            do_rotation: False
            rotation: 0
            total_rotation: 0
            size_hint: None, None

            width: self.parent.width
            height: self.parent.height - 60
            AsyncImage:
                id: image_source
                size_hint: 1,1
                width: self.parent.width
                height: self.parent.height - 10
                source: root.picture_path or "assets/pictureViewer.png"

        Label:
            id: image_name
            size_hint: 1, None
            height: '25px'
            halign: 'center'
            text: root.picture_name

        GridLayout:
            columns: 2
            rows: 1
            spacing: 10
            padding: self.width/2 - 40, 0, self.width/2 - 40, 0
            Button:
                text: "[font=assets/fontawesome-webfont.ttf][/font]"
                size_hint: None, 1
                width: '35px'
                height: '25px'
                on_press: root.rotate(90)

            Button:
                text: "[font=assets/fontawesome-webfont.ttf][/font]"
                size_hint: None, 1
                width: '35px'
                height: '25px'
                on_press: root.rotate(-90)

    ListView:
        size_hint: None, 1
        width: '150px'
        adapter: ListAdapter(data=root.files, cls=Factory.Pictures, args_converter=root.picturesListed, selection_mode='single')
